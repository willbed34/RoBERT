{"nbformat":4,"nbformat_minor":0,"metadata":{"colab":{"provenance":[],"machine_shape":"hm","gpuType":"T4"},"kernelspec":{"name":"python3","display_name":"Python 3"},"language_info":{"name":"python"},"accelerator":"GPU","widgets":{"application/vnd.jupyter.widget-state+json":{"7aabc91e45184aa9b304c4dd9b40e7c8":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_077ac2df9e6c4ba0a48f84e80efe51e6","IPY_MODEL_ef74cbae759145ff875c693568e9eb43","IPY_MODEL_82357e1de39d4603b56610ef1232cf4a"],"layout":"IPY_MODEL_622541c36cc44632be6bae4779d5eb1d"}},"077ac2df9e6c4ba0a48f84e80efe51e6":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_ea6e2d2fbb614af4a8d680975c524e8f","placeholder":"​","style":"IPY_MODEL_dc5baac386954cfb893ab8eda77778ae","value":"config.json: 100%"}},"ef74cbae759145ff875c693568e9eb43":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_cc737eeda0644a8292afc7bfa4a1ca97","max":812,"min":0,"orientation":"horizontal","style":"IPY_MODEL_990688e623cf4f36bf2c983596448f49","value":812}},"82357e1de39d4603b56610ef1232cf4a":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_d596c8c42be34603bec8a9ea82d48fc2","placeholder":"​","style":"IPY_MODEL_ec9699a5a7e449e98f52a6b0d0b5d083","value":" 812/812 [00:00&lt;00:00, 68.9kB/s]"}},"622541c36cc44632be6bae4779d5eb1d":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"ea6e2d2fbb614af4a8d680975c524e8f":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"dc5baac386954cfb893ab8eda77778ae":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"cc737eeda0644a8292afc7bfa4a1ca97":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"990688e623cf4f36bf2c983596448f49":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"d596c8c42be34603bec8a9ea82d48fc2":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"ec9699a5a7e449e98f52a6b0d0b5d083":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"2589e0eacfa2476fa3e1e75ed43487d1":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_607199514f23401e9d25702c1b19ccb6","IPY_MODEL_16ff5aeb7e8b4eecb53d56e49792115a","IPY_MODEL_233a165a4e4344acb015a2b22888e43f"],"layout":"IPY_MODEL_c937b34989374ac8ba16d358c21db749"}},"607199514f23401e9d25702c1b19ccb6":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_f008c170d4414447959947a7821a6ab4","placeholder":"​","style":"IPY_MODEL_8738348ddb9b4939a9f444f2b4c1918d","value":"vocab.json: 100%"}},"16ff5aeb7e8b4eecb53d56e49792115a":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_4576334d0c9247e48e89ccab820b8c37","max":1042301,"min":0,"orientation":"horizontal","style":"IPY_MODEL_1eb88c7c7b2d4bc09a636b364a51796c","value":1042301}},"233a165a4e4344acb015a2b22888e43f":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_c4e94329cdf54c90b9fc3f57f91875c5","placeholder":"​","style":"IPY_MODEL_74cf3c8fd8984beba38ef5b4a5a172ea","value":" 1.04M/1.04M [00:00&lt;00:00, 1.20MB/s]"}},"c937b34989374ac8ba16d358c21db749":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"f008c170d4414447959947a7821a6ab4":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"8738348ddb9b4939a9f444f2b4c1918d":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"4576334d0c9247e48e89ccab820b8c37":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"1eb88c7c7b2d4bc09a636b364a51796c":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"c4e94329cdf54c90b9fc3f57f91875c5":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"74cf3c8fd8984beba38ef5b4a5a172ea":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"d63ddc6b6f4143a2a2418995d13de14d":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_ba2c957d624044539745215b6488313a","IPY_MODEL_1e85a5b0bd4b4361be178e82c70bc51a","IPY_MODEL_7a7821a8848c419c83b64866119f6fc1"],"layout":"IPY_MODEL_36d1178ca3a14306ae79bcb29a4009c8"}},"ba2c957d624044539745215b6488313a":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_322d051112d14654b1ba8edf55e6962f","placeholder":"​","style":"IPY_MODEL_ffbede7e534e409ea8497feb41972e17","value":"merges.txt: 100%"}},"1e85a5b0bd4b4361be178e82c70bc51a":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_d2b5241c87bf480cb646f729c77fef53","max":456318,"min":0,"orientation":"horizontal","style":"IPY_MODEL_c63cb40978a2479ab46de2ff17865ddf","value":456318}},"7a7821a8848c419c83b64866119f6fc1":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_e93b848de2984e258f7768b8f72e0124","placeholder":"​","style":"IPY_MODEL_ea9cdf28d5e04190b032717c3a82f1b9","value":" 456k/456k [00:00&lt;00:00, 32.3MB/s]"}},"36d1178ca3a14306ae79bcb29a4009c8":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"322d051112d14654b1ba8edf55e6962f":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"ffbede7e534e409ea8497feb41972e17":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"d2b5241c87bf480cb646f729c77fef53":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"c63cb40978a2479ab46de2ff17865ddf":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"e93b848de2984e258f7768b8f72e0124":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"ea9cdf28d5e04190b032717c3a82f1b9":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"727ed1b237d04bd38f3a464e71a51047":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_b996da84dead497ebbd99e78d8942cc4","IPY_MODEL_9ad66f966a1d4e818ef871dea8c44fca","IPY_MODEL_6089a18cf70249009a0fcf94aeeed963"],"layout":"IPY_MODEL_03a8eb0b393745d39ad8aba023587ced"}},"b996da84dead497ebbd99e78d8942cc4":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_02189ad0d4354d8ba49bc0030a3fc969","placeholder":"​","style":"IPY_MODEL_d15e619dbb6245e39d913c4f51491e30","value":"special_tokens_map.json: 100%"}},"9ad66f966a1d4e818ef871dea8c44fca":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_00eacaf0fd4740be9c5af0624a127b9e","max":31,"min":0,"orientation":"horizontal","style":"IPY_MODEL_7a199522a435437597afac0f7d777f27","value":31}},"6089a18cf70249009a0fcf94aeeed963":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_75f3844352414bb6b51b7494aa674253","placeholder":"​","style":"IPY_MODEL_99dc42061d1944a1a81ced99e9dee2bf","value":" 31.0/31.0 [00:00&lt;00:00, 2.61kB/s]"}},"03a8eb0b393745d39ad8aba023587ced":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"02189ad0d4354d8ba49bc0030a3fc969":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"d15e619dbb6245e39d913c4f51491e30":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"00eacaf0fd4740be9c5af0624a127b9e":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"7a199522a435437597afac0f7d777f27":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"75f3844352414bb6b51b7494aa674253":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"99dc42061d1944a1a81ced99e9dee2bf":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"2b504636710d4eb79365d31dd7bc981c":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_a57cf6a82956484687a92a04e6c7681c","IPY_MODEL_b21f2d957ace4cd6886fa8255c3fcce0","IPY_MODEL_fab6525ddd284edd91dc8075de94959c"],"layout":"IPY_MODEL_28597813aaea44869154e7f290af0a10"}},"a57cf6a82956484687a92a04e6c7681c":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_7c1ac4cd004c46828a2d72429612f5e9","placeholder":"​","style":"IPY_MODEL_7a04d509911e4c00b08b415c1bd373e0","value":"pytorch_model.bin: 100%"}},"b21f2d957ace4cd6886fa8255c3fcce0":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_9de02854d7724355b8f2aa30f59ce841","max":1520029114,"min":0,"orientation":"horizontal","style":"IPY_MODEL_dd7b387817e248b0b3750d14562b196e","value":1520029114}},"fab6525ddd284edd91dc8075de94959c":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_12ddf7be83494eeda9f6e3436a886f5f","placeholder":"​","style":"IPY_MODEL_e4a586a340b6451e8d0d10de4f3248d6","value":" 1.52G/1.52G [00:05&lt;00:00, 324MB/s]"}},"28597813aaea44869154e7f290af0a10":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"7c1ac4cd004c46828a2d72429612f5e9":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"7a04d509911e4c00b08b415c1bd373e0":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"9de02854d7724355b8f2aa30f59ce841":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"dd7b387817e248b0b3750d14562b196e":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"12ddf7be83494eeda9f6e3436a886f5f":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"e4a586a340b6451e8d0d10de4f3248d6":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"3d1ce6fb13a84588b79e44efa1cb59d5":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_1d77123ba5164161a72a6ffd417d276c","IPY_MODEL_b9dba7294454462396662a563a4ab41b","IPY_MODEL_67c02544e6404090aa15b716f2441cb0"],"layout":"IPY_MODEL_2bd8135e82ac4de99b59392e1386e9d0"}},"1d77123ba5164161a72a6ffd417d276c":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_ae99628bb1284612892e3a8d84fe9b91","placeholder":"​","style":"IPY_MODEL_67e3c39d21a54856ad0d324fbe679650","value":"Epoch 0:   0%"}},"b9dba7294454462396662a563a4ab41b":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"","description":"","description_tooltip":null,"layout":"IPY_MODEL_9af035f5ba4e4b8baa00e4465bdc899f","max":50000,"min":0,"orientation":"horizontal","style":"IPY_MODEL_4eb2edd4846041788c370d03b30d96c1","value":60}},"67c02544e6404090aa15b716f2441cb0":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_40d79ebe7ea34a0b9e8a716b996ada43","placeholder":"​","style":"IPY_MODEL_5c91abab2713455d996c1f7ac59006e4","value":" 60/50000 [00:12&lt;2:49:15,  4.92it/s, v_num=96]"}},"2bd8135e82ac4de99b59392e1386e9d0":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":"inline-flex","flex":null,"flex_flow":"row wrap","grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":"100%"}},"ae99628bb1284612892e3a8d84fe9b91":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"67e3c39d21a54856ad0d324fbe679650":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"9af035f5ba4e4b8baa00e4465bdc899f":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":"2","flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"4eb2edd4846041788c370d03b30d96c1":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"40d79ebe7ea34a0b9e8a716b996ada43":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"5c91abab2713455d996c1f7ac59006e4":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}}}}},"cells":[{"cell_type":"markdown","source":["TOPIC: RobustBERT/RobustGPT (One of our teams will do GPT the other will do BERT) PROMPT: SENTIMENT CLASSIFICATION\n","\n","Workflow:\n","\n","1. Gather natural language data (depending on prompt)\n","2. Preprocess data (spacy, pytorch, huggingface, Tokenizer)\n","3. Implement models GPT/BERT and train against the collected data\n","4. Create algorithms for adversarial attacks against BERT/GPT (creating typos in words, using wrong synonyms, removing/adding random words, etc)\n","5. Create defenses against the attacks (maybe a second model for cleaning inputs/algorithm to correct typos/etc)"],"metadata":{"id":"-8SvIM-umzpQ"}},{"cell_type":"code","source":["import torch\n","from transformers import AutoTokenizer, GPT2ForSequenceClassification\n","from torch.nn.functional import softmax\n","\n","# Load the pre-trained model and tokenizer\n","tokenizer = AutoTokenizer.from_pretrained(\"microsoft/DialogRPT-updown\")\n","num_labels = 2  # Set the number of classes to 2 for binary classification\n","model = GPT2ForSequenceClassification.from_pretrained(\n","    \"microsoft/DialogRPT-updown\", num_labels=num_labels, ignore_mismatched_sizes=True, problem_type=\"multi_label_classification\"\n",")\n","\n","# Tokenize input text\n","inputs = tokenizer(\"Hello, my dog is cute\", return_tensors=\"pt\")\n","\n","# Forward pass through the model\n","with torch.no_grad():\n","    logits = model(**inputs).logits\n","\n","# Threshold the logits to get predicted class IDs\n","predicted_class_ids = torch.arange(0, logits.shape[-1])[torch.sigmoid(logits).squeeze(dim=0) > 0.5]\n","\n","# Create one-hot encoded labels for training\n","labels = torch.sum(\n","    torch.nn.functional.one_hot(predicted_class_ids[None, :].clone(), num_classes=num_labels), dim=1\n",").to(torch.float)\n","\n","# Forward pass with labels for training\n","loss = model(**inputs, labels=labels).loss\n","\n","# Get the predicted probabilities for each class using softmax\n","probs = softmax(logits, dim=1)\n","\n","# Get the predicted sentiment label\n","predicted_label = torch.argmax(probs, dim=1).item()\n","\n","print(f\"Predicted Sentiment Label: {predicted_label}\")\n","print(f\"Predicted Sentiment Probabilities: {probs.tolist()}\")"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":286,"referenced_widgets":["7aabc91e45184aa9b304c4dd9b40e7c8","077ac2df9e6c4ba0a48f84e80efe51e6","ef74cbae759145ff875c693568e9eb43","82357e1de39d4603b56610ef1232cf4a","622541c36cc44632be6bae4779d5eb1d","ea6e2d2fbb614af4a8d680975c524e8f","dc5baac386954cfb893ab8eda77778ae","cc737eeda0644a8292afc7bfa4a1ca97","990688e623cf4f36bf2c983596448f49","d596c8c42be34603bec8a9ea82d48fc2","ec9699a5a7e449e98f52a6b0d0b5d083","2589e0eacfa2476fa3e1e75ed43487d1","607199514f23401e9d25702c1b19ccb6","16ff5aeb7e8b4eecb53d56e49792115a","233a165a4e4344acb015a2b22888e43f","c937b34989374ac8ba16d358c21db749","f008c170d4414447959947a7821a6ab4","8738348ddb9b4939a9f444f2b4c1918d","4576334d0c9247e48e89ccab820b8c37","1eb88c7c7b2d4bc09a636b364a51796c","c4e94329cdf54c90b9fc3f57f91875c5","74cf3c8fd8984beba38ef5b4a5a172ea","d63ddc6b6f4143a2a2418995d13de14d","ba2c957d624044539745215b6488313a","1e85a5b0bd4b4361be178e82c70bc51a","7a7821a8848c419c83b64866119f6fc1","36d1178ca3a14306ae79bcb29a4009c8","322d051112d14654b1ba8edf55e6962f","ffbede7e534e409ea8497feb41972e17","d2b5241c87bf480cb646f729c77fef53","c63cb40978a2479ab46de2ff17865ddf","e93b848de2984e258f7768b8f72e0124","ea9cdf28d5e04190b032717c3a82f1b9","727ed1b237d04bd38f3a464e71a51047","b996da84dead497ebbd99e78d8942cc4","9ad66f966a1d4e818ef871dea8c44fca","6089a18cf70249009a0fcf94aeeed963","03a8eb0b393745d39ad8aba023587ced","02189ad0d4354d8ba49bc0030a3fc969","d15e619dbb6245e39d913c4f51491e30","00eacaf0fd4740be9c5af0624a127b9e","7a199522a435437597afac0f7d777f27","75f3844352414bb6b51b7494aa674253","99dc42061d1944a1a81ced99e9dee2bf","2b504636710d4eb79365d31dd7bc981c","a57cf6a82956484687a92a04e6c7681c","b21f2d957ace4cd6886fa8255c3fcce0","fab6525ddd284edd91dc8075de94959c","28597813aaea44869154e7f290af0a10","7c1ac4cd004c46828a2d72429612f5e9","7a04d509911e4c00b08b415c1bd373e0","9de02854d7724355b8f2aa30f59ce841","dd7b387817e248b0b3750d14562b196e","12ddf7be83494eeda9f6e3436a886f5f","e4a586a340b6451e8d0d10de4f3248d6"]},"id":"PG9X9Unfm2i5","executionInfo":{"status":"ok","timestamp":1702265444416,"user_tz":300,"elapsed":22552,"user":{"displayName":"Ian Gurland","userId":"00256412502361189335"}},"outputId":"07e33efb-2bba-48b0-bf17-c78562854286"},"execution_count":1,"outputs":[{"output_type":"display_data","data":{"text/plain":["config.json:   0%|          | 0.00/812 [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"7aabc91e45184aa9b304c4dd9b40e7c8"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["vocab.json:   0%|          | 0.00/1.04M [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"2589e0eacfa2476fa3e1e75ed43487d1"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["merges.txt:   0%|          | 0.00/456k [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"d63ddc6b6f4143a2a2418995d13de14d"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["special_tokens_map.json:   0%|          | 0.00/31.0 [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"727ed1b237d04bd38f3a464e71a51047"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["pytorch_model.bin:   0%|          | 0.00/1.52G [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"2b504636710d4eb79365d31dd7bc981c"}},"metadata":{}},{"output_type":"stream","name":"stderr","text":["Some weights of GPT2ForSequenceClassification were not initialized from the model checkpoint at microsoft/DialogRPT-updown and are newly initialized because the shapes did not match:\n","- score.weight: found shape torch.Size([1, 1024]) in the checkpoint and torch.Size([2, 1024]) in the model instantiated\n","You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.\n"]},{"output_type":"stream","name":"stdout","text":["Predicted Sentiment Label: 1\n","Predicted Sentiment Probabilities: [[0.30866649746894836, 0.691333532333374]]\n"]}]},{"cell_type":"code","source":["import torch\n","from torch.utils.data import DataLoader, Dataset\n","from tqdm import tqdm\n","\n","class SentimentDataset(Dataset):\n","    def __init__(self, texts, labels, tokenizer, max_length=128):\n","        self.texts = texts\n","        self.labels = labels\n","        self.tokenizer = tokenizer\n","        self.max_length = max_length\n","\n","    def __len__(self):\n","        return len(self.texts)\n","\n","    def __getitem__(self, idx):\n","        text = str(self.texts[idx])\n","        label = int(self.labels[idx])\n","        encoding = self.tokenizer(text, truncation=True, padding='max_length', max_length=self.max_length, return_tensors='pt')\n","\n","        return {\n","            'input_ids': encoding['input_ids'].flatten(),\n","            'attention_mask': encoding['attention_mask'].flatten(),\n","            'label': torch.tensor(label, dtype=torch.long)\n","        }"],"metadata":{"id":"kHqZOwum2ZXm","executionInfo":{"status":"ok","timestamp":1702265444417,"user_tz":300,"elapsed":23,"user":{"displayName":"Ian Gurland","userId":"00256412502361189335"}}},"execution_count":2,"outputs":[]},{"cell_type":"code","source":["%load_ext autoreload\n","%autoreload 2\n","#mount\n","from google.colab import drive\n","drive.mount('/content/gdrive')\n","%cd /content/gdrive/Shareddrives/RoBERT\n","!ls"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"dL8pO8PBRmkj","executionInfo":{"status":"ok","timestamp":1702265490687,"user_tz":300,"elapsed":46292,"user":{"displayName":"Ian Gurland","userId":"00256412502361189335"}},"outputId":"42579fac-5878-4fa1-cfa4-998027191f12"},"execution_count":3,"outputs":[{"output_type":"stream","name":"stdout","text":["Mounted at /content/gdrive\n","/content/gdrive/Shareddrives/RoBERT\n"," lightning_logs   preprocess.py   RoBERT    RobustGPT\t     train.csv\n"," logs\t\t  __pycache__\t  Robert2  'RobustGPT NEW'   TweetSentiment.csv\n"]}]},{"cell_type":"code","source":["import csv\n","def get_csv_data(input_csv_path):\n","  reviews = []\n","  labels = []\n","  # Read the CSV file and extract data\n","  i=0\n","  with open(input_csv_path, 'r') as csv_file:\n","      csv_reader = csv.reader(csv_file)\n","      for row in csv_reader:\n","          if i > 20000:\n","            break\n","          #the first column is the label and the last column is the tweet\n","          label = row[0]\n","          review = row[2]\n","          if label == '2':\n","            labels.append(1)\n","          else:\n","            labels.append(0)\n","          reviews.append(review)\n","          i+=1\n","\n","  return reviews, labels\n","\n","\n","#reviews, labels = get_csv_data(\"train.csv\")\n","import preprocess\n","reviews, labels = preprocess.get_csv_data(r\"TweetSentiment.csv\")\n","reviews, labels = reviews, labels\n","print(reviews[0:10])\n","print(labels[0:10])"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"Qs3bPuRm2aaZ","executionInfo":{"status":"ok","timestamp":1702265496084,"user_tz":300,"elapsed":5404,"user":{"displayName":"Ian Gurland","userId":"00256412502361189335"}},"outputId":"8a361ded-5cba-4eb2-e13f-1d9d4b2feef1"},"execution_count":4,"outputs":[{"output_type":"stream","name":"stdout","text":["[\"@switchfoot http://twitpic.com/2y1zl - Awww, that's a bummer.  You shoulda got David Carr of Third Day to do it. ;D\", \"is upset that he can't update his Facebook by texting it... and might cry as a result  School today also. Blah!\", '@Kenichan I dived many times for the ball. Managed to save 50%  The rest go out of bounds', 'my whole body feels itchy and like its on fire ', \"@nationwideclass no, it's not behaving at all. i'm mad. why am i here? because I can't see you all over there. \", '@Kwesidei not the whole crew ', 'Need a hug ', \"@LOLTrish hey  long time no see! Yes.. Rains a bit ,only a bit  LOL , I'm fine thanks , how's you ?\", \"@Tatiana_K nope they didn't have it \", '@twittera que me muera ? ']\n","[0, 0, 0, 0, 0, 0, 0, 0, 0, 0]\n"]}]},{"cell_type":"code","source":["from sklearn.model_selection import train_test_split\n","import numpy as np\n","\n","texts = np.array(reviews) # List of input texts\n","labels = np.array(labels)  # List of corresponding labels (0 or 1 for binary sentiment classification)\n","\n","'''print(texts)\n","print(labels)\n","print(len(texts))\n","print(len(labels))'''\n","\n","train_texts, temp_text, train_labels, temp_labels = train_test_split(texts, labels, test_size=0.01, random_state=42)\n","\n","val_texts, test_texts, val_labels, test_labels = train_test_split(temp_text, temp_labels, test_size=0.5, random_state=42)\n","\n","# Create data loaders\n","train_dataset = SentimentDataset(train_texts, train_labels, tokenizer)\n","val_dataset = SentimentDataset(val_texts, val_labels, tokenizer)\n","test_dataset = SentimentDataset(test_texts, test_labels, tokenizer)\n","\n","print(len(train_dataset.texts))\n","print(len(train_dataset.labels))\n","print(len(val_dataset.texts))\n","print(len(val_dataset.labels))\n","print(len(test_dataset.texts))\n","print(len(test_dataset.labels))"],"metadata":{"id":"vxzat40i_zDh","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1702265499967,"user_tz":300,"elapsed":3885,"user":{"displayName":"Ian Gurland","userId":"00256412502361189335"}},"outputId":"52d7537b-4299-4f2f-8272-7011248e06c2"},"execution_count":5,"outputs":[{"output_type":"stream","name":"stdout","text":["1584000\n","1584000\n","8000\n","8000\n","8000\n","8000\n"]}]},{"cell_type":"code","source":["!pip install pytorch_lightning\n","import pytorch_lightning as pl\n","from torch.utils.data import RandomSampler\n","\n","class RoBERTDataModule(pl.LightningDataModule):\n","    def __init__(self, train_dataset, val_dataset, test_dataset, batch_size):\n","        super(RoBERTDataModule, self).__init__()\n","        self.train_dataset = train_dataset\n","        self.val_dataset = val_dataset\n","        self.test_dataset = test_dataset\n","        self.batch_size = batch_size\n","\n","    def train_dataloader(self):\n","        train_data = DataLoader(self.train_dataset, sampler = RandomSampler(self.train_dataset, num_samples=50000), batch_size = self.batch_size)\n","        return train_data\n","\n","    def val_dataloader(self):\n","        val_data = DataLoader(self.val_dataset, batch_size = self.batch_size)\n","        return val_data\n","\n","    def test_dataloader(self):\n","        test_data = DataLoader(self.test_dataset, batch_size = self.batch_size)\n","        return test_data"],"metadata":{"id":"rTYHonDPA1mu","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1702265509117,"user_tz":300,"elapsed":9168,"user":{"displayName":"Ian Gurland","userId":"00256412502361189335"}},"outputId":"0c182fe0-a78d-4cba-d603-44ff80a1c966"},"execution_count":6,"outputs":[{"output_type":"stream","name":"stdout","text":["Collecting pytorch_lightning\n","  Downloading pytorch_lightning-2.1.2-py3-none-any.whl (776 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m776.9/776.9 kB\u001b[0m \u001b[31m13.8 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: numpy>=1.17.2 in /usr/local/lib/python3.10/dist-packages (from pytorch_lightning) (1.23.5)\n","Requirement already satisfied: torch>=1.12.0 in /usr/local/lib/python3.10/dist-packages (from pytorch_lightning) (2.1.0+cu118)\n","Requirement already satisfied: tqdm>=4.57.0 in /usr/local/lib/python3.10/dist-packages (from pytorch_lightning) (4.66.1)\n","Requirement already satisfied: PyYAML>=5.4 in /usr/local/lib/python3.10/dist-packages (from pytorch_lightning) (6.0.1)\n","Requirement already satisfied: fsspec[http]>2021.06.0 in /usr/local/lib/python3.10/dist-packages (from pytorch_lightning) (2023.6.0)\n","Collecting torchmetrics>=0.7.0 (from pytorch_lightning)\n","  Downloading torchmetrics-1.2.1-py3-none-any.whl (806 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m806.1/806.1 kB\u001b[0m \u001b[31m44.6 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: packaging>=20.0 in /usr/local/lib/python3.10/dist-packages (from pytorch_lightning) (23.2)\n","Requirement already satisfied: typing-extensions>=4.0.0 in /usr/local/lib/python3.10/dist-packages (from pytorch_lightning) (4.5.0)\n","Collecting lightning-utilities>=0.8.0 (from pytorch_lightning)\n","  Downloading lightning_utilities-0.10.0-py3-none-any.whl (24 kB)\n","Requirement already satisfied: requests in /usr/local/lib/python3.10/dist-packages (from fsspec[http]>2021.06.0->pytorch_lightning) (2.31.0)\n","Requirement already satisfied: aiohttp!=4.0.0a0,!=4.0.0a1 in /usr/local/lib/python3.10/dist-packages (from fsspec[http]>2021.06.0->pytorch_lightning) (3.9.1)\n","Requirement already satisfied: setuptools in /usr/local/lib/python3.10/dist-packages (from lightning-utilities>=0.8.0->pytorch_lightning) (67.7.2)\n","Requirement already satisfied: filelock in /usr/local/lib/python3.10/dist-packages (from torch>=1.12.0->pytorch_lightning) (3.13.1)\n","Requirement already satisfied: sympy in /usr/local/lib/python3.10/dist-packages (from torch>=1.12.0->pytorch_lightning) (1.12)\n","Requirement already satisfied: networkx in /usr/local/lib/python3.10/dist-packages (from torch>=1.12.0->pytorch_lightning) (3.2.1)\n","Requirement already satisfied: jinja2 in /usr/local/lib/python3.10/dist-packages (from torch>=1.12.0->pytorch_lightning) (3.1.2)\n","Requirement already satisfied: triton==2.1.0 in /usr/local/lib/python3.10/dist-packages (from torch>=1.12.0->pytorch_lightning) (2.1.0)\n","Requirement already satisfied: attrs>=17.3.0 in /usr/local/lib/python3.10/dist-packages (from aiohttp!=4.0.0a0,!=4.0.0a1->fsspec[http]>2021.06.0->pytorch_lightning) (23.1.0)\n","Requirement already satisfied: multidict<7.0,>=4.5 in /usr/local/lib/python3.10/dist-packages (from aiohttp!=4.0.0a0,!=4.0.0a1->fsspec[http]>2021.06.0->pytorch_lightning) (6.0.4)\n","Requirement already satisfied: yarl<2.0,>=1.0 in /usr/local/lib/python3.10/dist-packages (from aiohttp!=4.0.0a0,!=4.0.0a1->fsspec[http]>2021.06.0->pytorch_lightning) (1.9.3)\n","Requirement already satisfied: frozenlist>=1.1.1 in /usr/local/lib/python3.10/dist-packages (from aiohttp!=4.0.0a0,!=4.0.0a1->fsspec[http]>2021.06.0->pytorch_lightning) (1.4.0)\n","Requirement already satisfied: aiosignal>=1.1.2 in /usr/local/lib/python3.10/dist-packages (from aiohttp!=4.0.0a0,!=4.0.0a1->fsspec[http]>2021.06.0->pytorch_lightning) (1.3.1)\n","Requirement already satisfied: async-timeout<5.0,>=4.0 in /usr/local/lib/python3.10/dist-packages (from aiohttp!=4.0.0a0,!=4.0.0a1->fsspec[http]>2021.06.0->pytorch_lightning) (4.0.3)\n","Requirement already satisfied: MarkupSafe>=2.0 in /usr/local/lib/python3.10/dist-packages (from jinja2->torch>=1.12.0->pytorch_lightning) (2.1.3)\n","Requirement already satisfied: charset-normalizer<4,>=2 in /usr/local/lib/python3.10/dist-packages (from requests->fsspec[http]>2021.06.0->pytorch_lightning) (3.3.2)\n","Requirement already satisfied: idna<4,>=2.5 in /usr/local/lib/python3.10/dist-packages (from requests->fsspec[http]>2021.06.0->pytorch_lightning) (3.6)\n","Requirement already satisfied: urllib3<3,>=1.21.1 in /usr/local/lib/python3.10/dist-packages (from requests->fsspec[http]>2021.06.0->pytorch_lightning) (2.0.7)\n","Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.10/dist-packages (from requests->fsspec[http]>2021.06.0->pytorch_lightning) (2023.11.17)\n","Requirement already satisfied: mpmath>=0.19 in /usr/local/lib/python3.10/dist-packages (from sympy->torch>=1.12.0->pytorch_lightning) (1.3.0)\n","Installing collected packages: lightning-utilities, torchmetrics, pytorch_lightning\n","Successfully installed lightning-utilities-0.10.0 pytorch_lightning-2.1.2 torchmetrics-1.2.1\n"]}]},{"cell_type":"code","source":["import torch\n","import torch.nn.functional as F\n","from transformers import GPT2ForSequenceClassification, get_linear_schedule_with_warmup, AdamW\n","import pytorch_lightning as pl\n","\n","class GPTClassifier(pl.LightningModule):\n","    def __init__(self, num_labels, model_name=\"microsoft/DialogRPT-updown\"):\n","        super(GPTClassifier, self).__init__()\n","        self.gpt = GPT2ForSequenceClassification.from_pretrained(\n","            model_name,\n","            num_labels=num_labels,\n","            ignore_mismatched_sizes=True,\n","            problem_type=\"multi_label_classification\"\n","        )\n","        self.validation_outputs = []  # Initialize an empty list\n","\n","    def forward(self, input_ids, attention_mask=None):\n","        return self.gpt(input_ids, attention_mask=attention_mask).logits\n","\n","    def training_step(self, batch, batch_idx):\n","        input_ids = batch['input_ids']\n","        attention_mask = batch['attention_mask']\n","        labels = batch['label'].float()  # Ensure labels are of type torch.float32\n","\n","        outputs = self(input_ids, attention_mask)\n","\n","        # Flatten both outputs and labels\n","        outputs_flat = outputs.view(-1)\n","        labels_flat = labels.view(-1)\n","\n","        # Calculate binary cross-entropy loss\n","        loss = F.binary_cross_entropy_with_logits(outputs_flat, labels_flat)\n","\n","        return loss\n","\n","    '''def validation_step(self, batch, batch_idx):\n","        input_ids = batch['input_ids']\n","        attention_mask = batch['attention_mask']\n","        labels = batch['label'].float()  # Ensure labels are of type torch.float32\n","\n","        outputs = self(input_ids, attention_mask)\n","\n","        # Flatten both outputs and labels\n","        outputs_flat = outputs.view(-1)\n","        labels_flat = labels.view(-1)\n","\n","        # Calculate binary cross-entropy loss\n","        loss = F.binary_cross_entropy_with_logits(outputs_flat, labels_flat)\n","\n","        # Append the validation outputs for later access\n","        self.validation_outputs.append((outputs_flat, labels_flat, loss))\n","\n","        # Return the validation loss for the current batch\n","        return loss\n","\n","    def on_validation_epoch_end(self):\n","        # Concatenate validation outputs from all batches\n","        all_outputs_flat, all_labels_flat, _ = zip(*self.validation_outputs)\n","        all_outputs_flat = torch.cat(all_outputs_flat)\n","        all_labels_flat = torch.cat(all_labels_flat)\n","\n","        # Convert logits to probabilities using sigmoid activation\n","        probabilities = torch.sigmoid(all_outputs_flat)\n","\n","        # Threshold probabilities to get binary predictions\n","        predictions = (probabilities > 0.5).float()\n","\n","        # Calculate accuracy\n","        accuracy = torch.sum(predictions == all_labels_flat).float() / len(all_labels_flat)\n","\n","        # Print validation accuracy\n","        self.print(f'Validation Accuracy: {accuracy.item():.4f}')\n","\n","        # Clear the validation outputs for the next epoch\n","        self.validation_outputs = []'''\n","\n","    def configure_optimizers(self):\n","        optimizer = AdamW(self.parameters(), lr=2e-5)\n","        scheduler = get_linear_schedule_with_warmup(optimizer, num_warmup_steps=0, num_training_steps=1000)\n","        return {'optimizer': optimizer, 'lr_scheduler': {'scheduler': scheduler, 'interval': 'step'}}"],"metadata":{"id":"m0mm9ZfDMNuv","executionInfo":{"status":"ok","timestamp":1702265509119,"user_tz":300,"elapsed":8,"user":{"displayName":"Ian Gurland","userId":"00256412502361189335"}}},"execution_count":7,"outputs":[]},{"cell_type":"code","source":["#!nvidia-smi -l 1 | grep \"Total Memory\"\n","NUM_EPOCHS = 2\n","NUM_CLASSES = 2\n","BATCH_SIZE = 1 #batch size\n","num_labels = 2  # Replace with the actual number of labels in your task\n","\n","model = GPTClassifier(num_labels=1)\n","\n","trainer = pl.Trainer(accelerator='gpu',\n","                     devices=1,\n","                     max_epochs = NUM_EPOCHS,\n","                     min_epochs = NUM_EPOCHS)\n","trainer.max_split_size_mb = 100\n","data_module = RoBERTDataModule(train_dataset, val_dataset, test_dataset, batch_size=BATCH_SIZE)\n","trainer.fit(model, data_module)"],"metadata":{"id":"uNSBUFgCR0hl","colab":{"base_uri":"https://localhost:8080/","height":390,"referenced_widgets":["3d1ce6fb13a84588b79e44efa1cb59d5","1d77123ba5164161a72a6ffd417d276c","b9dba7294454462396662a563a4ab41b","67c02544e6404090aa15b716f2441cb0","2bd8135e82ac4de99b59392e1386e9d0","ae99628bb1284612892e3a8d84fe9b91","67e3c39d21a54856ad0d324fbe679650","9af035f5ba4e4b8baa00e4465bdc899f","4eb2edd4846041788c370d03b30d96c1","40d79ebe7ea34a0b9e8a716b996ada43","5c91abab2713455d996c1f7ac59006e4"]},"outputId":"67cb53ed-ae2c-409f-a8d3-0b076f10fca9"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stderr","text":["INFO:pytorch_lightning.utilities.rank_zero:GPU available: True (cuda), used: True\n","INFO:pytorch_lightning.utilities.rank_zero:TPU available: False, using: 0 TPU cores\n","INFO:pytorch_lightning.utilities.rank_zero:IPU available: False, using: 0 IPUs\n","INFO:pytorch_lightning.utilities.rank_zero:HPU available: False, using: 0 HPUs\n","/usr/local/lib/python3.10/dist-packages/pytorch_lightning/trainer/configuration_validator.py:72: You passed in a `val_dataloader` but have no `validation_step`. Skipping val loop.\n","INFO:pytorch_lightning.accelerators.cuda:LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]\n","/usr/local/lib/python3.10/dist-packages/transformers/optimization.py:411: FutureWarning: This implementation of AdamW is deprecated and will be removed in a future version. Use the PyTorch implementation torch.optim.AdamW instead, or set `no_deprecation_warning=True` to disable this warning\n","  warnings.warn(\n","INFO:pytorch_lightning.callbacks.model_summary:\n","  | Name | Type                          | Params\n","-------------------------------------------------------\n","0 | gpt  | GPT2ForSequenceClassification | 354 M \n","-------------------------------------------------------\n","354 M     Trainable params\n","0         Non-trainable params\n","354 M     Total params\n","1,419.297 Total estimated model params size (MB)\n","/usr/local/lib/python3.10/dist-packages/pytorch_lightning/trainer/connectors/data_connector.py:441: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=7` in the `DataLoader` to improve performance.\n"]},{"output_type":"display_data","data":{"text/plain":["Training: |          | 0/? [00:00<?, ?it/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"3d1ce6fb13a84588b79e44efa1cb59d5"}},"metadata":{}}]},{"cell_type":"code","source":["def classify(sentence):\n","  # Tokenize the input sentence and convert to tensor\n","  inputs = tokenizer(sentence, return_tensors=\"pt\")\n","\n","  input_ids = inputs[\"input_ids\"]\n","  attention_mask = (input_ids != tokenizer.pad_token_id).float()\n","\n","  # Forward pass through the model\n","  outputs = model(input_ids, attention_mask)\n","\n","  # Get the predicted probabilities for each class\n","  logits = outputs\n","  probs = torch.sigmoid(logits)\n","  print(probs)\n","  # Get the predicted sentiment label\n","  #if probs[0] < 0.5:\n","  #  predicted_label = 0\n","  #else:\n","  #  predicted_label = 1\n","\n","  # Get the predicted sentiment label\n","  #predicted_label = torch.argmax(probs).item()\n","\n","  return #predicted_label"],"metadata":{"id":"aNNRJ-BALV7S"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["classify(\"I hate you\")\n"],"metadata":{"id":"fRPEGJP3LsaZ"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["'''from torch.utils.data import DataLoader\n","from transformers import AdamW\n","from tqdm import tqdm\n","\n","#train_data and test_data are from prev cell,\n","#stored as [(sentence, sentiment), ...]\n","\n","#HYPERPARAMS\n","NUM_EPOCHS = 1\n","NUM_CLASSES = 2\n","BATCH_SIZE = 16 #batch size\n","#learning_rate = 1e-5\n","\n","model = BertClassifier(num_classes=NUM_CLASSES)\n","data_module = RoBERTDataModule(train_dataset, val_dataset, test_dataset, batch_size=BATCH_SIZE)\n","\n","trainer = pl.Trainer(accelerator='cpu',\n","                     devices=1,\n","                     max_epochs = NUM_EPOCHS,\n","                     min_epochs = NUM_EPOCHS) # Adjust parameters as needed\n","\n","trainer.fit(model, data_module)\n"],"metadata":{"id":"1Bp91on8Mx1D"},"execution_count":null,"outputs":[]}]}